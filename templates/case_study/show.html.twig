{% import "macros.html.twig" as macros %}
{% extends 'base.html.twig' %}

{% block meta_title -%}
    {{ caseStudy.metaTitle|default(caseStudy.title) }} | {{ parent() }}
{%- endblock %}

{% block meta_description -%}
    {{ caseStudy.metaDescription|default(caseStudy.description)|default(parent()) }}
{%- endblock %}

{% block og_image asset(caseStudy.images|first|glide_image_preset('opengraph_image')) %}
{% block twitter_image absolute_url(asset(caseStudy.images|first|glide_image_preset('twitter_card'))) %}

{% block content %}
    <div class="page-project container">
        <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
            <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a itemprop="item" href="{{ path('homepage') }}">
                    <span itemprop="name">Accueil</span>
                </a>
                <meta itemprop="position" content="1" />
            </li>
            <li class="breadcrumb__item"  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a itemprop="item" href="{{ path('case_studies') }}">
                    <span itemprop="name">Nos études de cas</span>
                </a>
                <meta itemprop="position" content="2" />
            </li>
            <li class="breadcrumb__item"  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a itemprop="item" href="#">
                    <span itemprop="name">{{ caseStudy.title }}</span>
                </a>
                <meta itemprop="position" content="3" />
            </li>
        </ol>

        <div class="banner-case-study">
            <h1 class="banner-case-study__title">Découvrez <span>{{ caseStudy.title }}</span></h1>

            <div class="banner-case-study__content">
                <div class="highlight">
                    <!--
                        Description brève du projet ou du client
                        Recommandé : 50 à 150 caractères
                    -->
                    <p>{{ caseStudy.description }}</p>
                    <i class="icon icon--semicolon" aria-hidden="true"></i>
                </div>

                <!--
                    3 images de preview maximum dont :
                        - 1 image principale obligatoire
                            - dans <div class="preview__main">
                            - dimensions 630x380px
                        - 2 images facultatives (mais préférables !)
                            - dans <div class="preview__list">
                            - dimensions 240x160px
                -->
                <div class="preview">
                    <div class="preview__main">
                        <img {{ macros.imageSrcset(caseStudy.images|first, 'case_study_banner') }} />
                    </div>
                    <div class="preview__list">
                        <ul>
                            {% for image in caseStudy.images|slice(1, 2) %}
                                <li>
                                    <img src="{{ asset(image) }}">
                                </li>
                            {% endfor %}
                        </ul>
                        <!-- Si aucun lien vers le site possible, ajouter .hidden au bouton pour le cacher et ne pas casser le layout -->
                        <a href="{{ caseStudy.websiteUrl }}" class="btn btn--secondary btn--animated {{ caseStudy.websiteUrl is empty ? 'hidden' }}" target="_blank">
                            <span>
                                Voir le site
                            </span>
                        </a>
                    </div>
                </div>

            </div>
        </div>

        <div class="page-project__detail">
            <ul class="tile-list">
                <li>
                    <small>Client</small>
                    <p>{{ caseStudy.clients }}</p>
                </li>
                <li class="tile">
                    <small>Taille du projet</small>
                    <p>{{ caseStudy.size }}</p>
                </li>
            </ul>
            <ul class="tile-list">
                <li class="tile tile--medium">
                    <small>Services Rix</small>
                    {% for service in caseStudy.services %}
                        <p>{{ service }}</p>
                    {% endfor %}
                </li>
                <li class="tile tile--large">
                    <small>Technologies</small>
                    {% include "glossary/term_list.html.twig" with {
                        terms: caseStudy.terms,
                        list_class: 'technologies technologies--light'
                    } only %}
                </li>
            </ul>
        </div>

        <div class="page-project__content">
            {{ caseStudy.content|raw }}

            <h2 class="h2--dash">D'autres études de cas</h2>
            <ul class="article-list">
                {% with %}
                    {% for caseStudy in randomStudies %}
                    <li class="miniature miniature--large">
                        <a href="{{ path('case_study', { caseStudy: caseStudy.slug }) }}" class="miniature__image">
                            <span class="image" style="{{ macros.backgroundImageSrcset(caseStudy.images|first, 'case_study_thumbnail.lg') }}"></span>
                        </a>
                        <div class="miniature__content">
                            <span class="info">{{ caseStudy.clients }}</span>
                            <a href="{{ path('case_study', { caseStudy: caseStudy.slug }) }}" class="title">{{ caseStudy.title }}</a>
                            <p class="description">{{ caseStudy.description }}</p>
                            <a href="{{ path('case_study', { caseStudy: caseStudy.slug }) }}" class="btn btn--secondary btn--animated">
                                <span>
                                    Voir l'étude de cas
                                </span>
                            </a>
                        </div>
                    </li>
                    {% endfor %}
                {% endwith %}
            </ul>
        </div>
    </div>
{% endblock content %}
